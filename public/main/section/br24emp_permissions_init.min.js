var app_permissions={route_permission:{profile:{init:function(){$(window).on("load",(function(){app.util.period(),app.util.nprogressinit(),$(".previous-surround, .next-surround").css("display","none"),NProgress.configure({parent:"#progress-bar-parent",showSpinner:!1}),app_permissions.route_permission.profile.init_next(),app.util.fixedheaderviewporthandler()}))},init_next:function(){var e=document.referrer,i=[];if(null!==JSON.parse(localStorage.getItem("Br24_"+app.env()+"_routepermissionsinfo_oorptoape")))null==e||""==e?($(".loader").append('<span style="position: absolute; top: 45%; left: 50%; transform: translateX(-50%) translateY(-50%); font-size: 22px; color: red; text-align:center">Another Route Matrix is open already.<br>for security reasons only one instance is allowed<br><a style="font-size:10px" href="/home">Back Home</a></span>'),NProgress.done(),$(".navbar-nav").remove(),$(".ibox-content").remove(),$(".loader").css("background","rgb(249,249,249, 0.5"),$(".nav-tabs").remove(),$(".ibox-title").remove(),$(".tab-content").remove()):($(".loader").append('<span style="position: absolute; top: 45%; left: 50%; transform: translateX(-50%) translateY(-50%); font-size: 22px; color: red; text-align:center">Another Route Matrix is open already.<br>for security reasons only one instance is allowed<br><a style="font-size:10px" href="/home">Back Home</a></span>'),NProgress.done(),$(".loader").css("background","rgb(249,249,249, 0.5"),$(".ibox-content").remove(),$(".nav-tabs").remove(),$(".tab-content").remove(),$(".navbar-nav").remove(),$(".ibox-title").remove());else{i.oorptoape={routepermissions_browsertabstatus:"open",timestamp:(new Date).getTime()},localStorage.setItem("Br24_"+app.env()+"_routepermissionsinfo_oorptoape",JSON.stringify(i.oorptoape)),app_permissions.route_permission.profile.get_rolepositionInfo_tab();var o=1;$(document).ajaxStop((function(){1==o&&(app_permissions.route_permission.profile.table(),app_permissions.route_permission.profile.add_edit_employeerolepermission_roleposition_permissions_colorbox(),o=2)})),window.onbeforeunload=function(){},window.onunload=function(){localStorage.removeItem("Br24_"+app.env()+"_routepermissionsinfo_oorptoape")}}},table:function(){$(document).ready((function(){var e=JSON.parse(localStorage.getItem("Br24_"+app.env()+"_routepermissionsinfo_tab"));if(null!==e)!1!==e.roleposition_tab&&($("#anchor_rolepositionInfo").closest("li").addClass("active"),$("#rolepositionInfo").addClass("active"),$("#anchor_rolepositionInfo").on("click",(function(e){e.preventDefault()}))),!1!==e.permissions_tab&&($("#anchor_documentationInfo").closest("li").addClass("active"),$("#permissionsInfo").addClass("active"),$("#anchor_documentationInfo").on("click",(function(e){e.preventDefault()})));else{$("#anchor_rolepositionInfo").closest("li").addClass("active"),$("#rolepositionInfo").addClass("active"),$("#anchor_rolepositionInfo").on("click",(function(e){e.preventDefault()}));var i=[];i.tabs={roleposition_tab:!0,permissions_tab:!1},localStorage.setItem("Br24_"+app.env()+"_routepermissionsinfo_tab",JSON.stringify(i.tabs)),$(".alert-dismissable").css("display","none")}var o="";$("a").click((function(e){o=e.target.id})),$("#anchor_rolepositionInfo").click((function(){var e=$("#anchor_employeerolepermissionInfo, #anchor_rolepositionInfo, #anchor_permissionsInfo"),i=$("#employeerolepermissionInfo, #rolepositionInfo, #permissionsInfo"),t=o.replace("anchor_","");e.parent().removeClass("active"),e.removeClass("active"),i.removeClass("active"),$(".has-error").removeClass("has-error"),$(".help-block").css("display","none"),$("#"+o).parent().addClass("active"),$("#"+o).addClass("active"),$("#"+t).addClass("active"),$("#"+o).on("click",(function(e){e.preventDefault()}));var a=[];a.tabs={roleposition_tab:!0,permissions_tab:!1},localStorage.setItem("Br24_"+app.env()+"_routepermissionsinfo_tab",JSON.stringify(a.tabs)),window.rolepositiontable.fixedHeader.enable(),window.rolepositiontable.fixedHeader.adjust(),window.permissionstable.fixedHeader.disable()})),$("#anchor_permissionsInfo").click((function(){var e=$("#anchor_employeerolepermissionInfo, #anchor_rolepositionInfo, #anchor_permissionsInfo"),i=$("#employeerolepermissionInfo, #rolepositionInfo, #permissionsInfo"),t=o.replace("anchor_","");e.parent().removeClass("active"),e.removeClass("active"),i.removeClass("active"),$(".has-error").removeClass("has-error"),$(".help-block").css("display","none"),$("#"+o).parent().addClass("active"),$("#"+o).addClass("active"),$("#"+t).addClass("active"),$("#"+o).on("click",(function(e){e.preventDefault()}));var a=[];a.tabs={roleposition_tab:!0,permissions_tab:!1},localStorage.setItem("Br24_"+app.env()+"_routepermissionsinfo_tab",JSON.stringify(a.tabs)),window.rolepositiontable.fixedHeader.disable(),window.permissionstable.fixedHeader.enable(),window.permissionstable.fixedHeader.adjust()})),$('[data-toggle="popover"]').popover({delay:{show:"500",hide:"100"}})})),app.util.nprogressdone(),app.util.fullscreenloading_end()},add_edit_employeerolepermission_roleposition_permissions_colorbox:function(){app_permissions.route_permission.profile.rolepermissions_table(),app_permissions.route_permission.profile.permissions_table(),app_permissions.route_permission.profile.handlefixedheaderpinning()},rolepermissions_table:function(){var document_height=$(document).height()-400;function getData(e){$.ajax({url:app.data.routepermission_getRoleRositioninfo_db_table,data:{getting_columns:!0},success:e})}$(document).ready((function(){getData((function(data){var dynamix_columns=[],columnNames=Object.keys(data.data[0]);for(var i in columnNames){var classNameforcheckboxes=null,be_searchable=!1;i>=2&&(classNameforcheckboxes="checkbox_col"),0!=i&&1!=i||(be_searchable=!0),dynamix_columns.push({orderable:!1,searchable:be_searchable,data:columnNames[i],className:classNameforcheckboxes})}window.rolepositiontable=$("#rolepositionTable").DataTable({pageLength:-1,lengthMenu:app.conf.table.lengthMenu,processing:!0,serverSide:!0,bFilter:!0,ordering:!0,responsive:!0,scrollCollapse:!0,bAutoWidth:!0,scrollX:!0,scrollY:document_height,fixedColumns:{leftColumns:2},aaSorting:[],stateSave:!0,stateDuration:-1,stateSaveCallback:function(e,i){var o=$("#status_filter option:selected").map((function(){return $(this).val()})).get().join("|"),t=$("#team_filter option:selected").map((function(){return $(this).val()})).get().join("|"),a=$("#position_filter option:selected").map((function(){return $(this).val()})).get().join("|"),s=$("#action_filter option:selected").map((function(){return $(this).val()})).get().join("|"),n=$("#editor_level_filter option:selected").map((function(){return $(this).val()})).get().join("|"),r=$("#sections_filter option:selected").map((function(){return $(this).val()})).get().join("|");i.filters={status:o,team:t,position:a,action:s,editor_level:n,sections:r},sessionStorage.setItem("Br24_"+app.env()+"_rolepositiontable_table_"+e.sInstance,JSON.stringify(i))},stateLoadCallback:function(e){return JSON.parse(sessionStorage.getItem("Br24_"+app.env()+"_rolepositiontable_table_"+e.sInstance))},oLanguage:{sProcessing:"<div class='loader_blank'></div><div class='processingblured'>"+eval("app.translations."+app.data.locale+".please_wait_loading")+"<br><img src='../img/loader.gif'></div><div class='no_blurtext'>"+eval("app.translations."+app.data.locale+".please_wait_loading")+"<br><img src='../img/loader.gif'></div>",sZeroRecords:eval("app.translations."+app.data.locale+".no_roles_added"),sSearch:eval("app.translations."+app.data.locale+".section_search")},ajax:{url:app.data.routepermission_getRoleRositioninfo_db_table,dataSrc:"data"},columnDefs:[{targets:"_all",width:40}],columns:dynamix_columns,dom:'<".controlsfortable"<"#export_buttonlocation.html5buttons">rf<"#position_filter.dataTables_filter"><"#team_filter.dataTables_filter"><"#editor_level_filter.dataTables_filter"><"#status_filter.dataTables_filter"><"#sections_filter.dataTables_filter"><"#clear_filter.html5buttons"><"clearfix"><".table_block"<".table_float_left"i><".table_float_right">>>t<".controlsfortable">',createdRow:function(e,i,o){var t=i.permission.split('data-permission="'),a=(t=t[1].split('"'))[0];$("td",e).attr("data-permission",a).addClass("parent").css("padding","")},drawCallback:function(e){$("#rolepositionTable_filter").css("padding-bottom: 10px"),$(".DTFC_LeftBodyWrapper").css("background-color","#fff");this.api();$('[data-toggle="popover"]').popover({delay:{show:"500",hide:"100"}}),app.util.nprogressdone(),$("input[type=search]").focus(),$(".ms-has-selections")[0]?$('a[name="clearallfilters"]').css("display","block"):$('a[name="clearallfilters"]').css("display","none");"vi"===app.data.locale||"en"===app.data.locale?("dd/mm/yy","dd/mm/yyyy",new RegExp("^([0]?[1-9]|[1|2][0-9]|[3][0|1])[./-]([0]?[1-9]|[1][0-2])[./-]([0-9]{4}|[0-9]{2})$")):"de"===app.data.locale&&("dd.mm.yy","dd.mm.yyyy",new RegExp("^([0]?[1-9]|[1|2][0-9]|[3][0|1])[./-]([0]?[1-9]|[1][0-2])[./-]([0-9]{4}|[0-9]{2})$")),"VND"==app.data.currency?"#,##0.## ₫":"USD"==app.data.currency?"$ #,##0.00":"EUR"==app.data.currency?"€ #,##0.00":"#,##0.## ₫",$("input[name*='edit_']").on("click",(function(e){e.stopImmediatePropagation(),app_permissions.route_permission.profile.handle_route_permission(this.name)})),$(".checkbox_col.parent").not("input[name*='edit_']").on("click",(function(e){e.stopImmediatePropagation();var i=window.rolepositiontable.cell(this).index().column,o=window.rolepositiontable.column(i).header(),t=$(o).html().replace(/ /g,"_").toLowerCase(),a=$(this).data("permission"),s="edit_"+t+"_"+a,n=$("input[name='edit_"+t+"_"+a+"']");n.is(":disabled")||(n.is(":checked")?n.prop("checked",!1):n.prop("checked",!0),app_permissions.route_permission.profile.handle_route_permission(s))})),$('input[type="checkbox"], .checkbox_col').css("cursor","pointer")}});var rememberwhichtdbefore=null;$(".dataTable tbody").on("mouseenter","td",(function(){if($("#rolepositionTable .dataTables_empty").is(":visible"));else{var e=window.rolepositiontable.cell(this).index().column,i=window.rolepositiontable.cell(this).index().row;0<=e&&37>=e&&($(window.rolepositiontable.cells().nodes()).removeClass("highlight"),$(window.rolepositiontable.column(e).nodes()).addClass("highlight"),$(window.rolepositiontable.columns().header()).removeClass("highlight"),$(window.rolepositiontable.columns().footer()).removeClass("highlight"),$(window.rolepositiontable.column(e).header()).addClass("highlight"),$(window.rolepositiontable.column(e).footer()).addClass("highlight")),rememberwhichtdbefore!==i&&$(".DTFC_LeftBodyLiner tr[data-dt-row='"+rememberwhichtdbefore+"']").css({"background-color":"#fff"}),rememberwhichtdbefore=i,$(".DTFC_LeftBodyLiner tr[data-dt-row='"+rememberwhichtdbefore+"']").css({"background-color":"#F5F5F5"})}})),$(".dataTable tbody").on("mouseleave",(function(){$("#rolepositionTable .dataTables_empty").is(":visible")||($(window.rolepositiontable.cells().nodes()).removeClass("highlight"),$(window.rolepositiontable.columns().header()).removeClass("highlight"),$(window.rolepositiontable.columns().footer()).removeClass("highlight"),$(".DTFC_LeftBodyLiner tr").css({"background-color":"#fff"}))})),app_permissions.route_permission.profile.filter.bySections(window.rolepositiontable),$("select#sections_filter").multiselect({columns:2,maxPlaceholderOpts:0,search:!0,texts:{placeholder:"All"}});var filter_load=JSON.parse(sessionStorage.getItem("Br24_"+app.env()+"_rolepositiontable_table_rolepositionTable"));if(null!==filter_load&&""!==filter_load.filters.sections){var array=filter_load.filters.sections.split("|");$("select#sections_filter").val(array),$("select#sections_filter").multiselect("reload")}$('a[name="clearallfilters"]').on("click",(function(){array=[],$("select#sections_filter").val(array),$("select#sections_filter").multiselect("reload"),$(".dataTable").DataTable().search("").columns().search("").draw()})),$("#role_permission_detail_form").areYouSure()}))}))},permissions_table:function(){window.permissionstable=$("#permissionsTable").DataTable({pageLength:-1,lengthMenu:app.conf.table.lengthMenu,processing:!0,serverSide:!0,bFilter:!0,ordering:!0,responsive:!0,scrollCollapse:!0,bAutoWidth:!0,fixedHeader:{header:!0,footer:!0,headerOffset:57,footerOffset:1},aaSorting:[],stateSave:!0,stateDuration:-1,stateSaveCallback:function(e,i){var o=$("#status_filter3 option:selected").map((function(){return $(this).val()})).get().join("|"),t=$("#team_filter3 option:selected").map((function(){return $(this).val()})).get().join("|"),a=$("#position_filter3 option:selected").map((function(){return $(this).val()})).get().join("|"),s=$("#action_filter3 option:selected").map((function(){return $(this).val()})).get().join("|"),n=$("#editor_level_filter3 option:selected").map((function(){return $(this).val()})).get().join("|");i.filters={status:o,team:t,position:a,action:s,editor_level:n},sessionStorage.setItem("Br24_"+app.env()+"_permissionstable_table_"+e.sInstance,JSON.stringify(i))},stateLoadCallback:function(e){return JSON.parse(sessionStorage.getItem("Br24_"+app.env()+"_permissionstable_table_"+e.sInstance))},oLanguage:{sProcessing:"<div class='loader_blank'></div><div class='processingblured'>"+eval("app.translations."+app.data.locale+".please_wait_loading")+"<br><img src='../img/loader.gif'></div><div class='no_blurtext'>"+eval("app.translations."+app.data.locale+".please_wait_loading")+"<br><img src='../img/loader.gif'></div>",sZeroRecords:eval("app.translations."+app.data.locale+".no_permissions_added")},ajax:{url:app.data.routepermission_getPermissionsinfo_db_table,dataSrc:"data"},columnDefs:[],columns:[{orderable:!1,searchable:!1,data:"numbering"},{orderable:!1,searchable:!1,data:"name"},{orderable:!1,searchable:!1,data:"actions"},{orderable:!1,searchable:!1,data:"last_updated_by"},{orderable:!1,searchable:!1,data:"last_updated"}],dom:'<".controlsfortable"<"#export_buttonlocation.html5buttons">rlf<"#position_filter.dataTables_filter"><"#team_filter.dataTables_filter"><"#editor_level_filter.dataTables_filter"><"#status_filter.dataTables_filter"><"#clear_filter.html5buttons"><"clearfix"><".table_block"<".table_float_left"i><".table_float_right"p>>>t<".controlsfortable"p>',drawCallback:function(settings){var api=this.api();function isEmpty(e){for(var i in e)if(e.hasOwnProperty(i))return!1;return!0}function pad(e,i){for(var o=""+e;o.length<i;)o="0"+o;return o}$('[data-toggle="popover"]').popover({delay:{show:"500",hide:"100"}}),app.util.nprogressdone();var prefered_dateFormat=null,patt=null,prefered_dateFormat_placeholder=null,number_format_per_locale=null,delimiter_for_splitting_variable=null,numberformat_locale=null;"vi"===app.data.locale||"en"===app.data.locale?(prefered_dateFormat="dd/mm/yy",prefered_dateFormat_placeholder="dd/mm/yyyy",patt=new RegExp("^([0]?[1-9]|[1|2][0-9]|[3][0|1])[./-]([0]?[1-9]|[1][0-2])[./-]([0-9]{4}|[0-9]{2})$"),delimiter_for_splitting_variable="/"):"de"===app.data.locale&&(prefered_dateFormat="dd.mm.yy",prefered_dateFormat_placeholder="dd.mm.yyyy",patt=new RegExp("^([0]?[1-9]|[1|2][0-9]|[3][0|1])[./-]([0]?[1-9]|[1][0-2])[./-]([0-9]{4}|[0-9]{2})$"),delimiter_for_splitting_variable="."),"VND"==app.data.currency?(number_format_per_locale="#,##0.## ₫",numberformat_locale="vi"):"USD"==app.data.currency?(number_format_per_locale="$ #,##0.00",numberformat_locale="en"):"EUR"==app.data.currency?(number_format_per_locale="€ #,##0.00",numberformat_locale="de"):(number_format_per_locale="#,##0.## ₫",numberformat_locale="vi"),$(document).ready((function(){var currentColorBox="",window_focus=!0;$(window).focus((function(){window_focus=!0})).blur((function(){window_focus=!1}));var checks_if_avatar_colorbox_is_open=null,success_ajax_then_refresh=null,been_out=null,refreshIntervalId=null,timer=function(){refreshIntervalId=setInterval((function(){}),100)},close_colorbox_refreshIntervalId=null,close_colorbox_timer=function(){close_colorbox_refreshIntervalId=setInterval((function(){$("#cb_add_employeerolepermission.ajax").colorbox.close(),$("#cb_edit_employeerolepermission.ajax").colorbox.close(),$("#cb_add_rolepermission.ajax").colorbox.close(),$("#cb_edit_rolepermission.ajax").colorbox.close(),$("#cb_add_permission.ajax").colorbox.close(),$("#cb_edit_permission.ajax").colorbox.close(),clearInterval(close_colorbox_refreshIntervalId)}),100)},cboxOptions={width:"95%",height:"85%"};$(window).resize((function(){["cb_add_employeerolepermission","cb_add_rolepermission","cb_add_permission","cb_edit_employeerolepermission","cb_edit_rolepermission","cb_edit_permission"].indexOf(currentColorBox)>-1&&$.colorbox.resize({width:window.innerWidth>parseInt(cboxOptions.maxWidth)?cboxOptions.maxWidth:cboxOptions.width,height:window.innerHeight>parseInt(cboxOptions.maxHeight)?cboxOptions.maxHeight:cboxOptions.height})})),$("#cb_add_permission.ajax").colorbox({rel:"nofollow",width:"95%",height:"85%",escKey:!1,overlayClose:!1,closeButton:!1,onOpen:function(){currentColorBox="cb_add_permission"},onLoad:function(){},onComplete:function(){NProgress.configure({parent:"#progress-bar-parent"}),$("#issue_date").prop("disabled",!0).prop("readonly",!0),$("#expiration_date").prop("disabled",!0).prop("readonly",!0),$("#doc_number").prop("disabled",!0).prop("readonly",!0),$("#issue_place").prop("disabled",!0).prop("readonly",!0);var counting_issue=1,$issuedate=$("#issue_date");$issuedate.datepicker({dateFormat:prefered_dateFormat,showMonthAfterYear:!0,numberOfMonths:1,changeMonth:!0,changeYear:!0,yearRange:"-100:+15",showOtherMonths:!0,selectOtherMonths:!0,toggleActive:!0,minDate:"-100y",maxDate:"+15y",autoclose:!0,onClose:function(){var addressinput=$(this).val(),res=patt.test(addressinput);1==res?($("#issue_date").closest("td").removeClass("has-error"),$("#issue_date").nextAll(".help-block").css("display","none"),$(this).blur(),counting_issue=1):($("#issue_date").closest("td").addClass("has-error"),1==counting_issue&&$("#issue_date").after('<span class="help-block"><strong>'+eval("app.translations."+app.data.locale+".you_need_to_enter_a_valid_date_in_the_format")+" "+prefered_dateFormat_placeholder+" "+eval("app.translations."+app.data.locale+".or_choose_from_the_calendar")+"</strong></span>"),counting_issue++,$(this).blur())},beforeShow:function(e,i){$issuedate.after($issuedate.datepicker("widget")),setTimeout((function(){$("#ui-datepicker-div").css("top","").css("left","")}),0)}});var counting_expire=1,$expiredate=$("#expiration_date");$expiredate.datepicker({dateFormat:prefered_dateFormat,showMonthAfterYear:!0,numberOfMonths:1,changeMonth:!0,changeYear:!0,yearRange:"-100:+15",showOtherMonths:!0,selectOtherMonths:!0,toggleActive:!0,minDate:"-100y",maxDate:"+15y",autoclose:!0,onClose:function(){var addressinput=$(this).val();if(""==addressinput)$("#expiration_date").closest("td").removeClass("has-error"),$("#expiration_date").nextAll(".help-block").css("display","none"),counting_expire=1;else{var res=patt.test(addressinput);1==res?($("#expiration_date").closest("td").removeClass("has-error"),$("#expiration_date").nextAll(".help-block").css("display","none"),$(this).blur(),counting_expire=1):($("#expire_date").closest("td").addClass("has-error"),1==counting_expire&&$("#expire_date").after('<span class="help-block"><strong>'+eval("app.translations."+app.data.locale+".you_need_to_enter_a_valid_date_in_the_format")+" "+prefered_dateFormat_placeholder+" "+eval("app.translations."+app.data.locale+".or_choose_from_the_calendar")+"</strong></span>"),counting_expire++,$(this).blur())}},beforeShow:function(e,i){$expiredate.after($expiredate.datepicker("widget")),setTimeout((function(){$("#ui-datepicker-div").css("top","").css("left","")}),0)}}),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$("#add_document_details_table").data("token")}});var data={},userId=app.data.userId,dropzone_isvisible_check=null,clickedtoadd_doc_type=null;$(document).ready((function(){$("input[data-ident=add_doc_file]").fileinput({language:app.data.locale,showUpload:!1,previewFileType:"any",showClose:!1,showCaption:!0,showBrowse:!0,browseClass:"btn btn-primary btn-file btn-fileinput-k",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i> ',showUploadedThumbs:!0,showPreview:!0,showRemove:!0,layoutTemplates:{size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n<div class="file-footer-caption" title="{caption}">\n<div class="file-caption-info">{caption}</div>\n<div class="file-size-info">{size}</div>\n</div>\n{progress}\n{indicator}\n{actions}\n</div>',actions:'<div class="file-actions">\n<div class="file-footer-buttons">\n{download} {upload} {delete} {other}</div>\n</div>\n<div class="clearfix"></div>'},preferIconicPreview:!1,previewFileIconSettings:{doc:'<i class="glyphicon glyphicon-file text-primary"></i>',xls:'<i class="glyphicon glyphicon-file text-success"></i>',ppt:'<i class="glyphicon glyphicon-file text-danger"></i>',pdf:'<i class="glyphicon glyphicon-file text-danger"></i>',zip:'<i class="glyphicon glyphicon-file text-muted"></i>',htm:'<i class="glyphicon glyphicon-file text-info"></i>',txt:'<i class="glyphicon glyphicon-file text-info"></i>',mov:'<i class="glyphicon glyphicon-file text-warning"></i>',mp3:'<i class="glyphicon glyphicon-file text-warning"></i>'},previewFileExtSettings:{doc:function(e){return e.match(/(doc|docx)$/i)},xls:function(e){return e.match(/(xls|xlsx)$/i)},ppt:function(e){return e.match(/(ppt|pptx)$/i)},pdf:function(e){return e.match(/(pdf)$/i)},zip:function(e){return e.match(/(zip|rar|tar|gzip|gz|7z)$/i)},htm:function(e){return e.match(/(htm|html)$/i)},txt:function(e){return e.match(/(txt|ini|csv|java|php|js|css)$/i)},mov:function(e){return e.match(/(avi|mpg|mkv|mov|mp4|3gp|webm|wmv)$/i)},mp3:function(e){return e.match(/(mp3|wav)$/i)}}}),$("input.file-caption-name").prop("disabled",!0).css("cursor","pointer"),$("input.file-caption-name").click((function(){$("input[type=file]").trigger("click")})),$("input[type=file]").change((function(){$("input.file-caption-name").val($(this).val())})),$("div.file-caption").click((function(){$("input[type=file]").trigger("click")})),$("div.file-drop-zone").css("cursor","pointer"),$("div.file-drop-zone").click((function(){$("input[type=file]").trigger("click")})),$(".kv-file-remove").click((function(e){e.stopImmediatePropagation()})),$(".kv-file-download").click((function(e){e.stopImmediatePropagation()})),$(".file-preview-thumbnails").click((function(e){e.stopImmediatePropagation(),console.log("clicked kv-file-thumbnails")})),$(".kv-fileinput-error").click((function(e){e.stopImmediatePropagation(),console.log("clicked kv-file-error")}));setInterval((function(){1==$("div.file-drop-zone-title").is(":visible")?$("div.file-drop-zone-title").css("cursor","pointer"):$("div.file-preview-frame").css("cursor","pointer"),1==$(".popover").is(":visible")&&$(".popover").css("z-index","20000000")}),500);$("#add_doc_type_button").click((function(){clickedtoadd_doc_type=1}));setInterval((function(){1==window_focus&&(null!==been_out&&1==clickedtoadd_doc_type&&($("select#doc_type_id").css("cursor","wait"),$("select#doc_type_id").prop("disabled",!0),$(".branch_loader").css("display","block"),app.ajax.json(app.data.urlProfileDocList,data,null,(function(){e=app.ajax.result.prefix;var i=Object.keys(e).length;app.data.howmanydocTypes!==i&&($("select#doc_type_id").empty().html(app.ajax.result.build),$("#prefix").val(""),console.log("updated-list"),app.data.howmanydocTypes=i),clearInterval(refreshIntervalId),$(".branch_loader").fadeOut("fast"),$("select#doc_type_id").css("cursor","auto"),$("select#doc_type_id").prop("disabled",!1)})),been_out=null,timer(),clickedtoadd_doc_type=null),$("select#doc_type_id").css("cursor","auto")),0==window_focus&&($("select#doc_type_id").css("cursor","pointer"),been_out=1,timer())}),500);var e=[];""!==$("#prefix").val()?($("select#doc_type_id").prop("disabled",!0).css("cursor","wait"),$(".branch_loader").css("display","block"),app.ajax.json(app.data.urlProfileDocList,data,null,(function(){$("select#doc_type_id").prop("disabled",!1).css("cursor","auto"),$(".branch_loader").fadeOut("fast"),e=app.ajax.result.prefix}))):($("select#doc_type_id").css("cursor","wait"),$("select#doc_type_id").prop("disabled",!0),$(".branch_loader").css("display","block"),app.ajax.json(app.data.urlProfileDocList,data,null,(function(){$("select#doc_type_id").empty().html(app.ajax.result.build),$("#prefix").val(""),e=app.ajax.result.prefix,$(".branch_loader").fadeOut("fast"),$("select#doc_type_id").css("cursor","auto").prop("disabled",!1)}))),0==$("select#doc_type_id").val()?$("#prefix").val(""):$.each(e,(function(e,i){var o=$("select#doc_type_id").val();if(i.id==o){var t=null;t=void 0!==app.data.document_numbering_for_naming[o]?app.data.document_numbering_for_naming[o].next_available_counter_for_this_doc_type_and_userid:"0001",$("#prefix").val(i.prefix+"_"+userId+"_"+t)}})),$("select#doc_type_id").change((function(){var i=$(this).val();$(this).children("option:selected").text();""==i?0==$("select#doc_type_id").val()&&($("#prefix").val(""),$("#upload_doc_reset").prop("disabled",!0).prop("readonly",!0).hide(),$("#upload_doc_update").prop("disabled",!0).prop("readonly",!0).hide(),$("#issue_date").prop("disabled",!0).prop("readonly",!0),$("#expiration_date").prop("disabled",!0).prop("readonly",!0),$("#doc_number").prop("disabled",!0).prop("readonly",!0),$("#issue_place").prop("disabled",!0).prop("readonly",!0)):($.each(e,(function(e,o){if(o.id==i){var t=null;t=void 0!==app.data.document_numbering_for_naming[i]?app.data.document_numbering_for_naming[i].next_available_counter_for_this_doc_type_and_userid:"0001",$("#prefix").val(o.prefix+"_"+userId+"_"+t)}})),$("#upload_doc_reset").prop("disabled",!1).prop("readonly",!1).css("display","inline-block"),$("#upload_doc_update").prop("disabled",!1).prop("readonly",!1).css("display","inline-block"),$("#issue_date").prop("disabled",!1).prop("readonly",!1),$("#expiration_date").prop("disabled",!1).prop("readonly",!1),$("#doc_number").prop("disabled",!1).prop("readonly",!1),$("#issue_place").prop("disabled",!1).prop("readonly",!1))}))})),$("#is_original").click((function(){1==$("#is_original:checkbox:checked").length>0?($("#is_copy").prop("checked",!1),$("#is_original_hidden").val(1),$("#is_copy_hidden").val(0)):($("#is_copy").prop("checked",!0),$("#is_original_hidden").val(0),$("#is_copy_hidden").val(1))})),$("#is_copy").click((function(){1==$("#is_copy:checkbox:checked").length>0?($("#is_original").prop("checked",!1),$("#is_original_hidden").val(0),$("#is_copy_hidden").val(1)):($("#is_original").prop("checked",!0),$("#is_original_hidden").val(1),$("#is_copy_hidden").val(0))})),$("#is_legalised").click((function(){1==$("#is_legalised:checkbox:checked").length>0?$("#is_legalised_hidden").val(1):$("#is_legalised_hidden").val(0)})),$("#is_notarised").click((function(){1==$("#is_notarised:checkbox:checked").length>0?$("#is_notarised_hidden").val(1):$("#is_notarised_hidden").val(0)}));var user=$("#user").val(),doc_type_id=$("#doc_type_id").val(),prefix=$("#prefix").val(),doc_no=$("#doc_no").val(),file=$("#file").val(),issue_date=$("#issue_date").val(),expiration_date=$("#expiration_date").val(),doc_number=$("#doc_number").val(),issue_place=$("#issue_place").val(),is_original=$("#is_original:checkbox:checked").length>0,is_copy=$("#is_copy:checkbox:checked").length>0,is_legalised=$("#is_legalised:checkbox:checked").length>0,is_notarised=$("#is_notarised:checkbox:checked").length>0,is_original_hidden=$("#is_original_hidden").val(),is_copy_hidden=$("#is_copy_hidden").val(),is_legalised_hidden=$("#is_legalised_hidden").val(),is_notarised_hidden=$("#is_notarised_hidden").val(),url_user_id=app.data.user_id,currentdate=new Date,datetime="Last Sync: "+currentdate.getDate()+"/"+(currentdate.getMonth()+1)+"/"+currentdate.getFullYear()+" @ "+currentdate.getHours()+":"+currentdate.getMinutes()+":"+currentdate.getSeconds(),add_document_submitted_data=[];add_document_submitted_data.add_document_submitted_data={whenwasset:datetime,user_id:url_user_id,add_document_user:user,add_document_doc_type_id:doc_type_id,add_document_prefix:prefix,add_document_doc_no:doc_no,add_document_file:file,add_document_issue_date:issue_date,add_document_expiration_date:expiration_date,add_document_doc_number:doc_number,add_document_issue_place:issue_place,add_document_is_original:is_original,add_document_is_copy:is_copy,add_document_is_legalised:is_legalised,add_document_is_notarised:is_notarised,add_document_is_original_hidden:is_original_hidden,add_document_is_copy_hidden:is_copy_hidden,add_document_is_legalised_hidden:is_legalised_hidden,add_document_is_notarised_hidden:is_notarised_hidden},sessionStorage.setItem("Br24_"+app.env()+"_"+url_user_id+"_add_uploaddocumentinfo_previous_data",JSON.stringify(add_document_submitted_data.add_document_submitted_data)),$("#cb_add_document_details_form").areYouSure(),$("#cb_add_document_details_form").on("change","select",(function(){$("#upload_doc_reset").prop("disabled",!1).css("display","inline-block"),$("#upload_doc_update").prop("disabled",!1).css("display","inline-block")})),$("#cb_add_document_details_form").on("change keypress","input",(function(){$("#upload_doc_reset").prop("disabled",!1).css("display","inline-block"),$("#upload_doc_update").prop("disabled",!1).css("display","inline-block")})),$("#upload_doc_reset").click((function(){$("#issue_date").prop("disabled",!0).prop("readonly",!0),$("#expiration_date").prop("disabled",!0).prop("readonly",!0),$("#upload_doc_reset, #upload_doc_update").prop("disabled",!0).css("display","none");var e=JSON.parse(sessionStorage.getItem("Br24_"+app.env()+"_"+url_user_id+"_add_uploaddocumentinfo_previous_data"));if($("#user").val(e.add_document_user),$("#doc_type_id").val(e.add_document_doc_type_id),$("#prefix").val(e.add_document_prefix),$("#doc_no").val(e.add_document_doc_no),""==e.add_document_file){$(document).ready((function(){$("input[data-ident=add_doc_file]").fileinput("clear").fileinput("destroy").fileinput({language:app.data.locale,showUpload:!1,previewFileType:"any",showClose:!1,showCaption:!0,showBrowse:!0,browseClass:"btn btn-primary btn-file btn-fileinput-k",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i> ',showUploadedThumbs:!0,showPreview:!0,showRemove:!0,layoutTemplates:{size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n<div class="file-footer-caption" title="{caption}">\n<div class="file-caption-info">{caption}</div>\n<div class="file-size-info">{size}</div>\n</div>\n{progress}\n{indicator}\n{actions}\n</div>',actions:'<div class="file-actions">\n<div class="file-footer-buttons">\n{download} {upload} {delete} {other}</div>\n</div>\n<div class="clearfix"></div>'},preferIconicPreview:!1,previewFileIconSettings:{doc:'<i class="glyphicon glyphicon-file text-primary"></i>',xls:'<i class="glyphicon glyphicon-file text-success"></i>',ppt:'<i class="glyphicon glyphicon-file text-danger"></i>',pdf:'<i class="glyphicon glyphicon-file text-danger"></i>',zip:'<i class="glyphicon glyphicon-file text-muted"></i>',htm:'<i class="glyphicon glyphicon-file text-info"></i>',txt:'<i class="glyphicon glyphicon-file text-info"></i>',mov:'<i class="glyphicon glyphicon-file text-warning"></i>',mp3:'<i class="glyphicon glyphicon-file text-warning"></i>'},previewFileExtSettings:{doc:function(e){return e.match(/(doc|docx)$/i)},xls:function(e){return e.match(/(xls|xlsx)$/i)},ppt:function(e){return e.match(/(ppt|pptx)$/i)},pdf:function(e){return e.match(/(pdf)$/i)},zip:function(e){return e.match(/(zip|rar|tar|gzip|gz|7z)$/i)},htm:function(e){return e.match(/(htm|html)$/i)},txt:function(e){return e.match(/(txt|ini|csv|java|php|js|css)$/i)},mov:function(e){return e.match(/(avi|mpg|mkv|mov|mp4|3gp|webm|wmv)$/i)},mp3:function(e){return e.match(/(mp3|wav)$/i)}}}),$("input.file-caption-name").prop("disabled",!0).css("cursor","pointer"),$("input.file-caption-name").click((function(){$("input[type=file]").trigger("click")})),$("input[type=file]").change((function(){$("input.file-caption-name").val($(this).val())})),$("div.file-caption").click((function(){$("input[type=file]").trigger("click")})),$("div.file-drop-zone").css("cursor","pointer"),$("div.file-drop-zone").click((function(){$("input[type=file]").trigger("click")})),$(".kv-file-remove").click((function(e){e.stopImmediatePropagation()})),$(".kv-file-download").click((function(e){e.stopImmediatePropagation()})),$(".file-preview-thumbnails").click((function(e){e.stopImmediatePropagation(),console.log("clicked kv-file-thumbnails")})),$(".kv-fileinput-error").click((function(e){e.stopImmediatePropagation(),console.log("clicked kv-file-error")}));setInterval((function(){1==$("div.file-drop-zone-title").is(":visible")?$("div.file-drop-zone-title").css("cursor","pointer"):$("div.file-preview-frame").css("cursor","pointer"),1==$(".popover").is(":visible")&&$(".popover").css("z-index","20000000")}),500)}))}$("#issue_date").val(e.add_document_issue_date),$("#expiration_date").val(e.add_document_expiration_date),$("#doc_number").val(e.add_document_doc_number),$("#issue_place").val(e.add_document_issue_place),$("#is_original:checkbox:checked").val(e.add_document_is_original),$("#is_copy:checkbox:checked").val(e.add_document_is_copy),$("#is_legalised:checkbox:checked").val(e.add_document_is_legalised),$("#is_notarised:checkbox:checked").val(e.add_document_is_notarised),1==e.add_document_is_original_hidden?($("#is_original").prop("checked",!0),$("#is_original_hidden").val(1)):($("#is_original").prop("checked",!1),$("#is_original_hidden").val(0)),1==e.add_document_is_copy_hidden?($("#is_copy").prop("checked",!0),$("#is_copy_hidden").val(1)):($("#is_copy").prop("checked",!1),$("#is_copy_hidden").val(0)),1==e.add_document_is_legalised_hidden?($("#is_legalised").prop("checked",!0),$("#is_legalised_hidden").val(1)):($("#is_legalised").prop("checked",!1),$("#is_legalised_hidden").val(0)),1==e.add_document_is_notarised_hidden?($("#is_notarised").prop("checked",!0),$("#is_notarised_hidden").val(1)):($("#is_notarised").prop("checked",!1),$("#is_notarised_hidden").val(0)),$(".has-error").removeClass("has-error"),$(".help-block").css("display","none"),$("#cb_add_document_details_form").trigger("reinitialize.areYouSure")})),$("#upload_doc_update").click((function(e){e.preventDefault(),$(".alert_warning").css("display","none"),$(".alert_success").css("display","none");var i=$("#user").val(),o=$("#doc_type_id").val(),t=$("#prefix").val(),a=$("#doc_no").val(),s=$("input[data-ident=add_doc_file]").val(),n=$("#issue_date").val(),r=$("#expiration_date").val(),l=$("#doc_number").val(),d=$("#issue_place").val(),c=$("#is_original:checkbox:checked").length>0,p=$("#is_copy:checkbox:checked").length>0,_=$("#is_legalised:checkbox:checked").length>0,u=$("#is_notarised:checkbox:checked").length>0,f=$("#is_original_hidden").val(),h=$("#is_copy_hidden").val(),m=$("#is_legalised_hidden").val(),g=$("#is_notarised_hidden").val(),v=app.data.user_id,b=new Date,y="Last Sync: "+b.getDate()+"/"+(b.getMonth()+1)+"/"+b.getFullYear()+" @ "+b.getHours()+":"+b.getMinutes()+":"+b.getSeconds(),x=[];x.add_document_submitted_data={whenwasset:y,user_id:v,add_document_user:i,add_document_doc_type_id:o,add_document_prefix:t,add_document_doc_no:a,add_document_file:s,add_document_issue_date:n,add_document_expiration_date:r,add_document_doc_number:l,add_document_issue_place:d,add_document_is_original:c,add_document_is_copy:p,add_document_is_legalised:_,add_document_is_notarised:u,add_document_is_original_hidden:f,add_document_is_copy_hidden:h,add_document_is_legalised_hidden:m,add_document_is_notarised_hidden:g},sessionStorage.setItem("Br24_"+app.env()+"_"+v+"_add_uploaddocumentinfo_submitted_data",JSON.stringify(x.add_document_submitted_data));var k=new FormData($("#cb_add_document_details_form")[0]);NProgress.configure({parent:"#cboxTitle",showSpinner:!1,easing:"ease",speed:880,trickleSpeed:333,trickle:!0}),NProgress.start(),$(".cb_loader").css("display","block").css("cursor","wait"),$("#cb_top").addClass("nprogress-busy").css("pointer-events","none"),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$("#add_document_details_table").data("token")}}),app.ajax.formdata(app.data.employee_add_employee_document,k,null,(function(){if(success_ajax_then_refresh=app.ajax.resultformdata.success,NProgress.done(),$(".cb_loader").css("display","none").css("cursor","auto"),$("#cb_top").removeClass("nprogress-busy").css("pointer-events","auto"),1==app.ajax.resultformdata.success)$("#cboxLoadedContent").css("background-color","#4CAF50"),$(".onSuccess_makeGreen").css("background-color","#4CAF50"),$(".ibox-tool-userid").css("color","white"),$("#cb_add_document_details_form").css("display","none"),close_colorbox_timer(),$(document.body).css("pointer-events","none"),app.util.fullscreenloading_start();else{if($(".has-error").removeClass("has-error"),$(".help-block").detach(),$.each(app.ajax.resultformdata.errors,(function(e,i){app_permissions.route_permission.profile.foreach_handle_error_display(e,i)})),isEmpty(app.ajax.resultformdata.errors));else{var e=$(".has-error:visible:first").offset().top-$(".has-error:visible:first").offsetParent().offset().top,i=$("#cboxLoadedContent").scrollTop()-Math.abs(e)-80;$("#cboxLoadedContent").animate({scrollTop:i},1e3)}var o=$(".has-error").length>0;1!=o&&0!=o||($("#user_id").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #user_id")})),$("#doc_type_id").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #doc_type_id")})),$("#prefix").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #prefix")})),$("#doc_no").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #doc_no")})),$("#file").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(".file-input").parent(".form-group").removeClass("has-error"),$(".file-caption").find(".help-block").remove(),$(this).next(".help-block").css("display","none"),console.log("something changed in #file")})),$("#issue_date").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #issue_date")})),$("#expiration_date").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #expire_date")})),$("#doc_number").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #doc_number")})),$("#issue_place").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #issue_place")})),$("#limitation_limited").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #limitation_limited")})),$("#limitation_unlimited").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #limitation_unlimited")})),$("#user_id").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #user_id")})),$("#is_original_have").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #is_original_have")})),$("#is_copy_have").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #is_copy_have")})),$("#is_legalised_have").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #is_legalised_have")})),$("#is_notarised_have").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #is_notarised_have")})),$("#limitation_have").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #limitation_have")})))}}))})),$("#cb_add_document_details_form").on("keyup keypress",(function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!1})),$("#cboxOverlay").off("click").on("click",(function(event){var identifychanges=$("#cb_add_document_details_form").hasClass("dirty");1==identifychanges?$.confirm({title:eval("app.translations."+app.data.locale+".title_text"),content:eval("app.translations."+app.data.locale+".you_have_unsaved_changes")+"\n"+eval("app.translations."+app.data.locale+".do_you_want_to_discard_those_changes")+"\n",type:"red",draggable:!1,backgroundDismiss:"cancel",escapeKey:!0,animateFromElement:!1,onAction:function(e){$(".jconfirm.jconfirm-light.jconfirm-open").remove()},buttons:{ok:{btnClass:"btn-primary text-white",keys:["enter"],text:eval("app.translations."+app.data.locale+".okay_text"),action:function(){event.stopPropagation(),$("#cb_add_doc.ajax").colorbox.close(),$("#cb_add_document_details_form").trigger("reinitialize.areYouSure")}},cancel:{text:eval("app.translations."+app.data.locale+".cancel_text"),action:function(){return!1}}}}):($("#cb_add_doc.ajax").colorbox.close(),$("#cb_add_document_details_form").trigger("reinitialize.areYouSure"))}))},onCleanup:function(){1==success_ajax_then_refresh&&app.util.fullscreenloading_start()},onClosed:function(){currentColorBox="",$(".modal-backdrop").remove(),$("body").css("cursor","default"),1==success_ajax_then_refresh&&(window.employeerolepermissiontable.ajax.reload(null,!1),window.rolepositiontable.ajax.reload(null,!1),window.permissionstable.ajax.reload(null,!1),app.util.fullscreenloading_end(),window.employeerolepermissiontable.fixedHeader.adjust(),window.rolepositiontable.fixedHeader.adjust(),window.permissionstable.fixedHeader.adjust()),NProgress.configure({parent:"#progress-bar-parent",showSpinner:!1,easing:"ease",speed:880,trickleSpeed:333,trickle:!0}),clearInterval(refreshIntervalId),clearInterval(close_colorbox_refreshIntervalId)}}),$("#cb_edit_permission.ajax").colorbox({rel:"nofollow",width:"95%",height:"85%",escKey:!1,overlayClose:!1,closeButton:!1,onOpen:function(){currentColorBox="cb_edit_permission"},onLoad:function(){},onComplete:function(){NProgress.configure({parent:"#progress-bar-parent"});var counting_issue=1,$issuedate=$("#issue_date");$issuedate.datepicker({dateFormat:prefered_dateFormat,showMonthAfterYear:!0,numberOfMonths:1,changeMonth:!0,changeYear:!0,yearRange:"-100:+15",showOtherMonths:!0,selectOtherMonths:!0,toggleActive:!0,minDate:"-100y",maxDate:"+15y",autoclose:!0,onClose:function(){var addressinput=$(this).val(),res=patt.test(addressinput);1==res?($("#issue_date").closest("td").removeClass("has-error"),$("#issue_date").nextAll(".help-block").css("display","none"),$(this).blur(),counting_issue=1):($("#issue_date").closest("td").addClass("has-error"),1==counting_issue&&$("#issue_date").after('<span class="help-block"><strong>'+eval("app.translations."+app.data.locale+".you_need_to_enter_a_valid_date_in_the_format")+" "+prefered_dateFormat_placeholder+" "+eval("app.translations."+app.data.locale+".or_choose_from_the_calendar")+"</strong></span>"),counting_issue++,$(this).blur())},beforeShow:function(e,i){$issuedate.after($issuedate.datepicker("widget")),setTimeout((function(){$("#ui-datepicker-div").css("top","").css("left","")}),0)}});var counting_expire=1,$expiredate=$("#expiration_date");$expiredate.datepicker({dateFormat:prefered_dateFormat,showMonthAfterYear:!0,numberOfMonths:1,changeMonth:!0,changeYear:!0,yearRange:"-100:+15",showOtherMonths:!0,selectOtherMonths:!0,toggleActive:!0,minDate:"-100y",maxDate:"+15y",autoclose:!0,onClose:function(){var addressinput=$(this).val(),res=patt.test(addressinput);if(""==addressinput)$("#expiration_date").closest("td").removeClass("has-error"),$("#expiration_date").nextAll(".help-block").css("display","none"),counting_expire=1;else{var res=patt.test(addressinput);1==res?($("#expiration_date").closest("td").removeClass("has-error"),$("#expiration_date").nextAll(".help-block").css("display","none"),$(this).blur(),counting_expire=1):($("#expire_date").closest("td").addClass("has-error"),1==counting_expire&&$("#expire_date").after('<span class="help-block"><strong>'+eval("app.translations."+app.data.locale+".you_need_to_enter_a_valid_date_in_the_format")+" "+prefered_dateFormat_placeholder+" "+eval("app.translations."+app.data.locale+".or_choose_from_the_calendar")+"</strong></span>"),counting_expire++,$(this).blur())}},beforeShow:function(e,i){$expiredate.after($expiredate.datepicker("widget")),setTimeout((function(){$("#ui-datepicker-div").css("top","").css("left","")}),0)}}),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$("#edit_document_details_table").data("token")}});var data={},userId=app.data.userId,todayDate=(new Date).toISOString().slice(0,10),dropzone_isvisible_check=null,clickedtoadd_doc_type=null;$(document).ready((function(){var url1=app.data.dd_route,url2=app.data.dd_route_delete;$("input[data-ident=edit_doc_file]").fileinput({language:app.data.locale,showUpload:!1,previewFileType:"any",showClose:!1,showCaption:!0,showBrowse:!0,browseClass:"btn btn-primary btn-file btn-fileinput-k",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i> ',showUploadedThumbs:!0,showPreview:!0,showRemove:!0,initialPreview:url1,initialPreviewFileType:"image",initialPreviewAsData:!0,initialPreviewConfig:[{type:app.data.dd_type,caption:app.data.dd_prefix,downloadUrl:url1,url:url2,size:app.data.dd_size,width:"120px",key:1}],initialPreviewShowDelete:!0,overwriteInitial:!0,maxFileSize:25e3,initialCaption:app.data.dd_prefix,layoutTemplates:{size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n<div class="file-footer-caption" title="{caption}">\n<div class="file-caption-info">{caption}</div>\n<div class="file-size-info">{size}</div>\n</div>\n{progress}\n{indicator}\n{actions}\n</div>',actions:'<div class="file-actions">\n<div class="file-footer-buttons">\n{download} {upload} {delete} {other}</div>\n</div>\n<div class="clearfix"></div>'},preferIconicPreview:!1,previewFileIconSettings:{doc:'<i class="glyphicon glyphicon-file text-primary"></i>',xls:'<i class="glyphicon glyphicon-file text-success"></i>',ppt:'<i class="glyphicon glyphicon-file text-danger"></i>',pdf:'<i class="glyphicon glyphicon-file text-danger"></i>',zip:'<i class="glyphicon glyphicon-file text-muted"></i>',htm:'<i class="glyphicon glyphicon-file text-info"></i>',txt:'<i class="glyphicon glyphicon-file text-info"></i>',mov:'<i class="glyphicon glyphicon-file text-warning"></i>',mp3:'<i class="glyphicon glyphicon-file text-warning"></i>'},previewFileExtSettings:{doc:function(e){return e.match(/(doc|docx)$/i)},xls:function(e){return e.match(/(xls|xlsx)$/i)},ppt:function(e){return e.match(/(ppt|pptx)$/i)},pdf:function(e){return e.match(/(pdf)$/i)},zip:function(e){return e.match(/(zip|rar|tar|gzip|gz|7z)$/i)},htm:function(e){return e.match(/(htm|html)$/i)},txt:function(e){return e.match(/(txt|ini|csv|java|php|js|css)$/i)},mov:function(e){return e.match(/(avi|mpg|mkv|mov|mp4|3gp|webm|wmv)$/i)},mp3:function(e){return e.match(/(mp3|wav)$/i)}}}).on("filebeforedelete",(function(event,key,data){return new Promise((function(resolve,reject){$.confirm({title:eval("app.translations."+app.data.locale+".title_text"),content:eval("app.translations."+app.data.locale+".are_you_sure_you_want_to_delete_this_file")+"\n"+eval("app.translations."+app.data.locale+".this_cannot_be_undone")+"\n",type:"red",draggable:!1,backgroundDismiss:"cancel",escapeKey:!0,animateFromElement:!1,onAction:function(e){$(".jconfirm.jconfirm-light.jconfirm-open").remove()},buttons:{ok:{btnClass:"btn-primary text-white",keys:["enter"],text:eval("app.translations."+app.data.locale+".okay_text"),action:function(){resolve()}},cancel:{text:eval("app.translations."+app.data.locale+".cancel_text"),action:function(){$.alert(eval("app.translations."+app.data.locale+".file_deletion_was_aborted"))}}}})}))})).on("filepredelete",(function(e,i,o,t){})).on("filedeleted",(function(event,key,jqXHR,data){var resultformdata=JSON.stringify(jqXHR.responseJSON);if(console.log(jqXHR.responseJSON.success),console.log(typeof jqXHR.responseJSON.success),1==jqXHR.responseJSON.success){$.alert(eval("app.translations."+app.data.locale+".file_deletion_was_successful"));var generaldocstable=$("#generaldocumentsTable").DataTable();generaldocstable.ajax.reload(null,!1),generaldocstable.fixedHeader.adjust()}else $.alert(eval("app.translations."+app.data.locale+".file_deletion_was_unsuccessful"))})),$("input.file-caption-name").prop("disabled",!0).css("cursor","pointer"),$("input.file-caption-name").click((function(){$("input[type=file]").trigger("click")})),$("input[type=file]").change((function(){$("input.file-caption-name").val($(this).val())})),$("div.file-caption").click((function(){$("input[type=file]").trigger("click")})),$("div.file-drop-zone").css("cursor","pointer"),$("div.file-drop-zone").click((function(){$("input[type=file]").trigger("click")})),$(".kv-file-remove").click((function(e){e.stopImmediatePropagation()})),$(".kv-file-download").click((function(e){e.stopImmediatePropagation()})),$(".file-preview-thumbnails").click((function(e){e.stopImmediatePropagation(),console.log("clicked kv-file-thumbnails")})),$(".kv-fileinput-error").click((function(e){e.stopImmediatePropagation(),console.log("clicked kv-file-error")}));var constantlychecking_if_timer=setInterval((function(){1==$("div.file-drop-zone-title").is(":visible")?$("div.file-drop-zone-title").css("cursor","pointer"):$("div.file-preview-frame").css("cursor","pointer"),1==$(".popover").is(":visible")&&$(".popover").css("z-index","20000000")}),500),whatarewelookingat=setInterval((function(){1==window_focus&&(null!==been_out&&1==clickedtoadd_doc_type&&($("select#doc_type_id").css("cursor","wait"),$("select#doc_type_id").prop("disabled",!0),$(".branch_loader").css("display","block"),app.ajax.json(app.data.urlProfileDocList,data,null,(function(){documentlist=app.ajax.result.prefix;var e=Object.keys(documentlist).length;app.data.howmanydocTypes!==e&&($("select#doc_type_id").empty().html(app.ajax.result.build),$("#prefix").val(""),console.log("updated-list"),app.data.howmanydocTypes=e),clearInterval(refreshIntervalId),$(".branch_loader").fadeOut("fast"),$("select#doc_type_id").css("cursor","auto"),$("select#doc_type_id").prop("disabled",!1)})),been_out=null,timer(),clickedtoadd_doc_type=null),$("select#doc_type_id").css("cursor","auto")),0==window_focus&&($("select#doc_type_id").css("cursor","pointer"),been_out=1,timer())}),500),documentlist=[];""!==$("#prefix").val()?($("select#doc_type_id").css("cursor","wait").prop("disabled",!0),$(".branch_loader").css("display","block"),app.ajax.json(app.data.urlProfileDocList,data,null,(function(){documentlist=app.ajax.result.prefix,$(".branch_loader").fadeOut("fast"),$("select#doc_type_id").prop("disabled",!1).css("cursor","auto")}))):($("select#doc_type_id").prop("disabled",!0).css("cursor","wait"),$(".branch_loader").css("display","block"),app.ajax.json(app.data.urlProfileDocList,data,null,(function(){$(".branch_loader").fadeOut("fast"),$("select#doc_type_id").css("cursor","auto").prop("disabled",!1),documentlist=app.ajax.result.prefix}))),$("select#doc_type_id").change((function(){var e=$(this).val();""==e?0==$("select#doc_type_id").val()&&($("#prefix").val(""),$("#upload_doc_reset").prop("disabled",!0).prop("readonly",!0).hide(),$("#upload_doc_update").prop("disabled",!0).prop("readonly",!0).hide(),$("#issue_date").prop("disabled",!0).prop("readonly",!0),$("#expiration_date").prop("disabled",!0).prop("readonly",!0),$("#doc_number").prop("disabled",!0).prop("readonly",!0),$("#issue_place").prop("disabled",!0).prop("readonly",!0)):($.each(documentlist,(function(i,o){if(o.id==e){var t=$("#prefix").val().split("_"),a=o.prefix+"_"+userId+"_"+t[2];$("#prefix").val(a),$(".file-caption-name").text(a),$("input.file-caption-name").prop("title",a).text(a),$("#prefix").closest("td").removeClass("has-error"),$("#prefix").next(".help-block").css("display","none")}})),$("#upload_doc_reset").prop("disabled",!1).prop("readonly",!1).css("display","inline-block"),$("#upload_doc_update").prop("disabled",!1).prop("readonly",!1).css("display","inline-block"),$("#issue_date").prop("disabled",!1).prop("readonly",!1),$("#expiration_date").prop("disabled",!1).prop("readonly",!1),$("#doc_number").prop("disabled",!1).prop("readonly",!1),$("#issue_place").prop("disabled",!1).prop("readonly",!1))}))})),$("#is_original").click((function(){1==$("#is_original:checkbox:checked").length>0?($("#is_copy").prop("checked",!1),$("#is_original_hidden").val(1),$("#is_copy_hidden").val(0)):($("#is_copy").prop("checked",!0),$("#is_original_hidden").val(0),$("#is_copy_hidden").val(1))})),$("#is_copy").click((function(){1==$("#is_copy:checkbox:checked").length>0?($("#is_original").prop("checked",!1),$("#is_original_hidden").val(0),$("#is_copy_hidden").val(1)):($("#is_original").prop("checked",!0),$("#is_original_hidden").val(1),$("#is_copy_hidden").val(0))})),$("#is_legalised").click((function(){1==$("#is_legalised:checkbox:checked").length>0?$("#is_legalised_hidden").val(1):$("#is_legalised_hidden").val(0)})),$("#is_notarised").click((function(){1==$("#is_notarised:checkbox:checked").length>0?$("#is_notarised_hidden").val(1):$("#is_notarised_hidden").val(0)}));var user=$("#user").val(),doc_type_id=$("#doc_type_id").val(),prefix=$("#prefix").val(),doc_no=$("#doc_no").val(),file=$("input[data-ident=edit_doc_file]").val(),issue_date=$("#issue_date").val(),expiration_date=$("#expiration_date").val(),issue_place=$("#issue_place").val(),is_original=$("#is_original:checkbox:checked").length>0,is_copy=$("#is_copy:checkbox:checked").length>0,is_legalised=$("#is_legalised:checkbox:checked").length>0,is_notarised=$("#is_notarised:checkbox:checked").length>0,is_original_hidden=$("#is_original_hidden").val(),is_copy_hidden=$("#is_copy_hidden").val(),is_legalised_hidden=$("#is_legalised_hidden").val(),is_notarised_hidden=$("#is_notarised_hidden").val(),url_user_id=app.data.user_id,currentdate=new Date,datetime="Last Sync: "+currentdate.getDate()+"/"+(currentdate.getMonth()+1)+"/"+currentdate.getFullYear()+" @ "+currentdate.getHours()+":"+currentdate.getMinutes()+":"+currentdate.getSeconds(),edit_document_previous_data=[];edit_document_previous_data.edit_document_previous_data={whenwasset:datetime,user_id:url_user_id,edit_document_user:user,edit_document_doc_type_id:doc_type_id,edit_document_prefix:prefix,edit_document_doc_no:doc_no,edit_document_file:file,edit_document_issue_date:issue_date,edit_document_expiration_date:expiration_date,edit_document_issue_place:issue_place,edit_document_is_original:is_original,edit_document_is_copy:is_copy,edit_document_is_legalised:is_legalised,edit_document_is_notarised:is_notarised,edit_document_is_original_hidden:is_original_hidden,edit_document_is_copy_hidden:is_copy_hidden,edit_document_is_legalised_hidden:is_legalised_hidden,edit_document_is_notarised_hidden:is_notarised_hidden},sessionStorage.setItem("Br24_"+app.env()+"_"+url_user_id+"_edit_uploaddocumentinfo_previous_data",JSON.stringify(edit_document_previous_data.edit_document_previous_data)),2!=app.data.fk_doc_type_id&&3!=app.data.fk_doc_type_id&&4!=app.data.fk_doc_type_id&&5!=app.data.fk_doc_type_id&&6!=app.data.fk_doc_type_id&&7!=app.data.fk_doc_type_id||($("#issue_date").prop("disabled",!0).prop("readonly",!0),$("#expiration_date").prop("disabled",!0).prop("readonly",!0)),$("#cb_edit_document_details_form").areYouSure(),$("#cb_edit_document_details_form").on("change","select",(function(){$("#upload_doc_reset").prop("disabled",!1).css("display","inline-block"),$("#upload_doc_update").prop("disabled",!1).css("display","inline-block")})),$("#cb_edit_document_details_form").on("change keypress","input",(function(){$("#upload_doc_reset").prop("disabled",!1).css("display","inline-block"),$("#upload_doc_update").prop("disabled",!1).css("display","inline-block")})),$("#upload_doc_reset").click((function(){var button_selector=$("#upload_doc_reset, #upload_doc_update");button_selector.prop("disabled",!0).css("display","none");var previous_load=JSON.parse(sessionStorage.getItem("Br24_"+app.env()+"_"+url_user_id+"_edit_uploaddocumentinfo_previous_data"));$("#user").val(previous_load.edit_document_user),$("#doc_type_id").val(previous_load.edit_document_doc_type_id),$("#prefix").val(previous_load.edit_document_prefix),$("#doc_no").val(previous_load.edit_document_doc_no),$("#issue_date").val(previous_load.edit_document_issue_date),$("#expiration_date").val(previous_load.edit_document_expiration_date),$("#issue_place").val(previous_load.edit_document_issue_place),$("#is_original:checkbox:checked").val(previous_load.edit_document_is_original),$("#is_copy:checkbox:checked").val(previous_load.edit_document_is_copy),$("#is_legalised:checkbox:checked").val(previous_load.edit_document_is_legalised),$("#is_notarised:checkbox:checked").val(previous_load.edit_document_is_notarised),1==previous_load.edit_document_is_original_hidden?($("#is_original").prop("checked",!0),$("#is_original_hidden").val(1)):($("#is_original").prop("checked",!1),$("#is_original_hidden").val(0)),1==previous_load.edit_document_is_copy_hidden?($("#is_copy").prop("checked",!0),$("#is_copy_hidden").val(1)):($("#is_copy").prop("checked",!1),$("#is_copy_hidden").val(0)),1==previous_load.edit_document_is_legalised_hidden?($("#is_legalised").prop("checked",!0),$("#is_legalised_hidden").val(1)):($("#is_legalised").prop("checked",!1),$("#is_legalised_hidden").val(0)),1==previous_load.edit_document_is_notarised_hidden?($("#is_notarised").prop("checked",!0),$("#is_notarised_hidden").val(1)):($("#is_notarised").prop("checked",!1),$("#is_notarised_hidden").val(0));var dropzone_isvisible_check=null,clickedtoadd_doc_type=null;""==previous_load.edit_document_file&&$(document).ready((function(){var url1=app.data.dd_route,url2=app.data.dd_route_delete;$("input[data-ident=edit_doc_file]").fileinput("clear").fileinput("destroy").fileinput({language:app.data.locale,showUpload:!1,previewFileType:"any",showClose:!1,showCaption:!0,showBrowse:!0,browseClass:"btn btn-primary btn-file btn-fileinput-k",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i> ',showUploadedThumbs:!0,showPreview:!0,showRemove:!0,initialPreview:url1,initialPreviewFileType:"image",initialPreviewAsData:!0,initialPreviewConfig:[{type:app.data.dd_type,caption:app.data.dd_prefix,downloadUrl:url1,url:url2,size:app.data.dd_size,width:"120px",key:1}],initialPreviewShowDelete:!0,overwriteInitial:!0,maxFileSize:25e3,initialCaption:app.data.dd_prefix,layoutTemplates:{size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n<div class="file-footer-caption" title="{caption}">\n<div class="file-caption-info">{caption}</div>\n<div class="file-size-info">{size}</div>\n</div>\n{progress}\n{indicator}\n{actions}\n</div>',actions:'<div class="file-actions">\n<div class="file-footer-buttons">\n{download} {upload} {delete} {other}</div>\n</div>\n<div class="clearfix"></div>'},preferIconicPreview:!1,previewFileIconSettings:{doc:'<i class="glyphicon glyphicon-file text-primary"></i>',xls:'<i class="glyphicon glyphicon-file text-success"></i>',ppt:'<i class="glyphicon glyphicon-file text-danger"></i>',pdf:'<i class="glyphicon glyphicon-file text-danger"></i>',zip:'<i class="glyphicon glyphicon-file text-muted"></i>',htm:'<i class="glyphicon glyphicon-file text-info"></i>',txt:'<i class="glyphicon glyphicon-file text-info"></i>',mov:'<i class="glyphicon glyphicon-file text-warning"></i>',mp3:'<i class="glyphicon glyphicon-file text-warning"></i>'},previewFileExtSettings:{doc:function(e){return e.match(/(doc|docx)$/i)},xls:function(e){return e.match(/(xls|xlsx)$/i)},ppt:function(e){return e.match(/(ppt|pptx)$/i)},pdf:function(e){return e.match(/(pdf)$/i)},zip:function(e){return e.match(/(zip|rar|tar|gzip|gz|7z)$/i)},htm:function(e){return e.match(/(htm|html)$/i)},txt:function(e){return e.match(/(txt|ini|csv|java|php|js|css)$/i)},mov:function(e){return e.match(/(avi|mpg|mkv|mov|mp4|3gp|webm|wmv)$/i)},mp3:function(e){return e.match(/(mp3|wav)$/i)}}}).on("filebeforedelete",(function(event,key,data){return new Promise((function(resolve,reject){$.confirm({title:eval("app.translations."+app.data.locale+".title_text"),content:eval("app.translations."+app.data.locale+".are_you_sure_you_want_to_delete_this_file")+"\n"+eval("app.translations."+app.data.locale+".this_cannot_be_undone")+"\n",type:"red",draggable:!1,backgroundDismiss:"cancel",escapeKey:!0,animateFromElement:!1,onAction:function(e){$(".jconfirm.jconfirm-light.jconfirm-open").remove()},buttons:{ok:{btnClass:"btn-primary text-white",keys:["enter"],text:eval("app.translations."+app.data.locale+".okay_text"),action:function(){resolve()}},cancel:{text:eval("app.translations."+app.data.locale+".cancel_text"),action:function(){$.alert(eval("app.translations."+app.data.locale+".file_deletion_was_aborted"))}}}})}))})).on("filepredelete",(function(e,i,o,t){})).on("filedeleted",(function(event,key,jqXHR,data){var resultformdata=JSON.stringify(jqXHR.responseJSON);if(1==jqXHR.responseJSON.success){$.alert(eval("app.translations."+app.data.locale+".file_deletion_was_successful"));var generaldocstable=$("#generaldocumentsTable").DataTable();generaldocstable.ajax.reload(null,!1),generaldocstable.fixedHeader.adjust()}else $.alert(eval("app.translations."+app.data.locale+".file_deletion_was_unsuccessful"))})),$("input.file-caption-name").prop("disabled",!0).css("cursor","pointer"),$("input.file-caption-name").click((function(){$("input[type=file]").trigger("click")})),$("input[type=file]").change((function(){$("input.file-caption-name").val($(this).val())})),$("div.file-caption").click((function(){$("input[type=file]").trigger("click")})),$("div.file-drop-zone").css("cursor","pointer"),$("div.file-drop-zone").click((function(){$("input[type=file]").trigger("click")})),$(".kv-file-remove").click((function(e){e.stopImmediatePropagation()})),$(".kv-file-download").click((function(e){e.stopImmediatePropagation()})),$(".file-preview-thumbnails").click((function(e){e.stopImmediatePropagation(),console.log("clicked kv-file-thumbnails")})),$(".kv-fileinput-error").click((function(e){e.stopImmediatePropagation(),console.log("clicked kv-file-error")}));var constantlychecking_if_timer=setInterval((function(){1==$("div.file-drop-zone-title").is(":visible")?$("div.file-drop-zone-title").css("cursor","pointer"):$("div.file-preview-frame").css("cursor","pointer"),1==$(".popover").is(":visible")&&$(".popover").css("z-index","20000000")}),500),whatarewelookingat=setInterval((function(){1==window_focus&&(null!==been_out&&1==clickedtoadd_doc_type&&($("select#doc_type_id").css("cursor","wait"),$("select#doc_type_id").prop("disabled",!0),$(".branch_loader").css("display","block"),app.ajax.json(app.data.urlProfileDocList,data,null,(function(){documentlist=app.ajax.result.prefix;var e=Object.keys(documentlist).length;app.data.howmanydocTypes!==e&&($("select#doc_type_id").empty().html(app.ajax.result.build),$("#prefix").val(""),console.log("updated-list"),app.data.howmanydocTypes=e),clearInterval(refreshIntervalId),$(".branch_loader").fadeOut("fast"),$("select#doc_type_id").css("cursor","auto"),$("select#doc_type_id").prop("disabled",!1)})),been_out=null,timer(),clickedtoadd_doc_type=null),$("select#doc_type_id").css("cursor","auto")),0==window_focus&&($("select#doc_type_id").css("cursor","pointer"),been_out=1,timer())}),500),documentlist=[];""!==$("#prefix").val()?($("select#doc_type_id").prop("disabled",!0).css("cursor","wait"),$(".branch_loader").css("display","block"),app.ajax.json(app.data.urlProfileDocList,data,null,(function(){$(".branch_loader").fadeOut("fast"),documentlist=app.ajax.result.prefix,$("select#doc_type_id").css("cursor","auto").prop("disabled",!1)}))):($("select#doc_type_id").css("cursor","wait").prop("disabled",!0),$(".branch_loader").css("display","block"),app.ajax.json(app.data.urlProfileDocList,data,null,(function(){documentlist=app.ajax.result.prefix,$(".branch_loader").fadeOut("fast"),$("select#doc_type_id").prop("disabled",!1).css("cursor","auto")}))),$("select#doc_type_id").change((function(){var e=$(this).val();""==e?0==$("select#doc_type_id").val()&&($("#prefix").val(""),$("#upload_doc_reset").prop("disabled",!0).prop("readonly",!0).hide(),$("#upload_doc_update").prop("disabled",!0).prop("readonly",!0).hide(),$("#issue_date").prop("disabled",!0).prop("readonly",!0),$("#expiration_date").prop("disabled",!0).prop("readonly",!0)):($.each(documentlist,(function(i,o){if(o.id==e){var t=$("#prefix").val().split("_"),a=o.prefix+"_"+userId+"_"+t[2];$("#prefix").val(a),$(".file-caption-name").text(a),$("input.file-caption-name").prop("title",a).text(a),$("#prefix").closest("td").removeClass("has-error"),$("#prefix").next(".help-block").css("display","none")}})),$("#upload_doc_reset").prop("disabled",!1).prop("readonly",!1).css("display","inline-block"),$("#upload_doc_update").prop("disabled",!1).prop("readonly",!1).css("display","inline-block"),$("#issue_date").prop("disabled",!1).prop("readonly",!1),$("#expiration_date").prop("disabled",!1).prop("readonly",!1))}))})),$(".has-error").removeClass("has-error"),$(".help-block").css("display","none"),$("#cb_edit_document_details_form").trigger("reinitialize.areYouSure")})),$("#upload_doc_update").click((function(e){e.preventDefault(),$(".alert_warning").css("display","none"),$(".alert_success").css("display","none"),$("#issue_date").prop("disabled",!1).prop("readonly",!0),$("#expiration_date").prop("disabled",!1).prop("readonly",!0);var i=$("#user").val(),o=$("#doc_type_id").val(),t=$("#prefix").val(),a=$("#doc_no").val(),s=$("input[data-ident=edit_doc_file]").val(),n=$("#issue_date").val(),r=$("#expiration_date").val(),l=$("#issue_place").val(),d=$("#is_original:checkbox:checked").length>0,c=$("#is_copy:checkbox:checked").length>0,p=$("#is_legalised:checkbox:checked").length>0,_=$("#is_notarised:checkbox:checked").length>0,u=$("#is_original_hidden").val(),f=$("#is_copy_hidden").val(),h=$("#is_legalised_hidden").val(),m=$("#is_notarised_hidden").val(),g=app.data.user_id,v=new Date,b="Last Sync: "+v.getDate()+"/"+(v.getMonth()+1)+"/"+v.getFullYear()+" @ "+v.getHours()+":"+v.getMinutes()+":"+v.getSeconds(),y=[];y.edit_document_submitted_data={whenwasset:b,user_id:g,edit_document_user:i,edit_document_doc_type_id:o,edit_document_prefix:t,edit_document_doc_no:a,edit_document_file:s,edit_document_issue_date:n,edit_document_expiration_date:r,edit_document_issue_place:l,edit_document_is_original:d,edit_document_is_copy:c,edit_document_is_legalised:p,edit_document_is_notarised:_,edit_document_is_original_hidden:u,edit_document_is_copy_hidden:f,edit_document_is_legalised_hidden:h,edit_document_is_notarised_hidden:m},sessionStorage.setItem("Br24_"+app.env()+"_"+g+"_edit_uploaddocumentinfo_submitted_data",JSON.stringify(y.edit_document_submitted_data));var x=new FormData($("#cb_edit_document_details_form")[0]);NProgress.configure({parent:"#cboxTitle",showSpinner:!1,easing:"ease",speed:880,trickleSpeed:333,trickle:!0}),NProgress.start(),$(".cb_loader").css("display","block").css("cursor","wait"),$("#cb_top").addClass("nprogress-busy").css("pointer-events","none"),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$("#edit_document_details_table").data("token")}}),app.ajax.formdata(app.data.employee_edit_employee_document,x,null,(function(){if(success_ajax_then_refresh=app.ajax.resultformdata.success,NProgress.done(),$(".cb_loader").css("display","none").css("cursor","auto"),$("#cb_top").removeClass("nprogress-busy").css("pointer-events","auto"),1==app.ajax.resultformdata.success)$("#cboxLoadedContent").css("background-color","#4CAF50"),$(".onSuccess_makeGreen").css("background-color","#4CAF50"),$(".ibox-tool-userid").css("color","white"),$("#cb_edit_document_details_form").css("display","none"),close_colorbox_timer(),$(document.body).css("pointer-events","none"),app.util.fullscreenloading_start();else{if($(".has-error").removeClass("has-error"),$(".help-block").detach(),$.each(app.ajax.resultformdata.errors,(function(e,i){app_permissions.route_permission.profile.foreach_handle_error_display(e,i)})),isEmpty(app.ajax.resultformdata.errors));else{var e=$(".has-error:visible:first").offset().top-$(".has-error:visible:first").offsetParent().offset().top,i=$("#cboxLoadedContent").scrollTop()-Math.abs(e)-80;$("#cboxLoadedContent").animate({scrollTop:i},1e3)}var o=$(".has-error").length>0;1!=o&&0!=o||($("#user_id").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #user_id")})),$("#doc_type_id").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #doc_type_id")})),$("#prefix").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #prefix")})),$("#doc_no").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #doc_no")})),$("#file").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(".file-input").parent(".form-group").removeClass("has-error"),$(".file-caption").find(".help-block").remove(),$(this).next(".help-block").css("display","none"),console.log("something changed in #file")})),$("#issue_date").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #issue_date")})),$("#expiration_date").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #expiration_date")})),$("#issue_place").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #issue_place")})),$("#limitation_limited").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #limitation_limited")})),$("#limitation_unlimited").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #limitation_unlimited")})),$("#user_id").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #user_id")})),$("#is_original_have").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #is_original_have")})),$("#is_copy_have").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #is_copy_have")})),$("#is_legalised_have").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #is_legalised_have")})),$("#is_notarised_have").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #is_notarised_have")})),$("#limitation_have").on("change keypress",(function(){$(this).parent(".form-group").removeClass("has-error"),$(this).next(".help-block").css("display","none"),console.log("something changed in #limitation_have")})))}}))})),$("#cb_edit_document_details_form").on("keyup keypress",(function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!1})),$("#cboxOverlay").off("click").on("click",(function(event){var identifychanges=$("#cb_edit_document_details_form").hasClass("dirty");1==identifychanges?$.confirm({title:eval("app.translations."+app.data.locale+".title_text"),content:eval("app.translations."+app.data.locale+".you_have_unsaved_changes")+"\n"+eval("app.translations."+app.data.locale+".do_you_want_to_discard_those_changes")+"\n",type:"red",draggable:!1,backgroundDismiss:"cancel",escapeKey:!0,animateFromElement:!1,onAction:function(e){$(".jconfirm.jconfirm-light.jconfirm-open").remove()},buttons:{ok:{btnClass:"btn-primary text-white",keys:["enter"],text:eval("app.translations."+app.data.locale+".okay_text"),action:function(){event.stopPropagation(),$("#cb_edit_doc.ajax").colorbox.close(),$("#cb_edit_document_details_form").trigger("reinitialize.areYouSure")}},cancel:{text:eval("app.translations."+app.data.locale+".cancel_text"),action:function(){return!1}}}}):($("#cb_edit_doc.ajax").colorbox.close(),$("#cb_edit_document_details_form").trigger("reinitialize.areYouSure"))}))},onCleanup:function(){1==success_ajax_then_refresh&&app.util.fullscreenloading_start()},onClosed:function(){currentColorBox="",$(".modal-backdrop").remove(),$("body").css("cursor","default"),1==success_ajax_then_refresh&&(window.employeerolepermissiontable.ajax.reload(null,!1),window.rolepositiontable.ajax.reload(null,!1),window.permissionstable.ajax.reload(null,!1),app.util.fullscreenloading_end(),window.employeerolepermissiontable.fixedHeader.adjust(),window.rolepositiontable.fixedHeader.adjust(),window.permissionstable.fixedHeader.adjust()),NProgress.configure({parent:"#progress-bar-parent",showSpinner:!1,easing:"ease",speed:880,trickleSpeed:333,trickle:!0}),clearInterval(refreshIntervalId),clearInterval(close_colorbox_refreshIntervalId)}}),$("a[name*='delete_permission_']").on("click",(function(event){event.preventDefault();var clicked_href=$(this).attr("href");$.confirm({title:eval("app.translations."+app.data.locale+".title_text"),content:eval("app.translations."+app.data.locale+".are_you_sure_you_want_to_delete_this_record")+"\n"+eval("app.translations."+app.data.locale+".this_cannot_be_undone")+"?\n",type:"red",draggable:!1,backgroundDismiss:"cancel",escapeKey:!0,animateFromElement:!1,onAction:function(e){$(".jconfirm.jconfirm-light.jconfirm-open").remove()},buttons:{ok:{btnClass:"btn-primary text-white",keys:["enter"],text:eval("app.translations."+app.data.locale+".okay_text"),action:function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),app.util.nprogressinit();app.ajax.jsonGET(clicked_href,{},null,(function(){1==app.ajax.result.success?(window.permissionstable.ajax.reload(null,!1),app.util.fullscreenloading_end(),window.permissionstable.fixedHeader.adjust(),app.util.nprogressdone()):app.util.nprogressdone()}))}},cancel:{text:eval("app.translations."+app.data.locale+".cancel_text"),action:function(){$.alert(eval("app.translations."+app.data.locale+".permission_record_deletion_was_aborted"))}}}})}))}))}})},handlefixedheaderpinning:function(){var e,i,o="";$(window).scroll((function(){clearTimeout(e),e=setTimeout((function(){var e=$(".visitor").outerHeight(!0);o!=e&&(window.rolepositiontable.fixedHeader.headerOffset(e),window.rolepositiontable.fixedHeader.adjust(),o=e)}),250)})),$(window).resize((function(){clearTimeout(i),i=setTimeout((function(){var e=$(".visitor").outerHeight(!0);o!=e&&(window.rolepositiontable.fixedHeader.headerOffset(e),window.rolepositiontable.fixedHeader.adjust(),o=e)}),250)}))},routes_fixed_header_scroll_with_scroll_handler:function(){var e=0,i=35,o=null,t=null,a=null,s=null;$("#rolepositionInfo .table-responsive").on("scroll",(function(n){o=n.currentTarget.scrollLeft,n.currentTarget.scrollTop,e=-1*o,t=$("#rolepositionInfo .table-responsive").scrollLeft(),a=$("#rolepositionInfo .table-responsive").width(),s=a+t-1,$(".controlsfortable").css({"padding-left":o,width:s.toFixed(2)}),window.location.href.indexOf("route_permissions")>-1&&(i=25),$(".fixedHeader-floating[aria-describedby='rolepositionTable_info']").css({left:e+i}),window.rolepositiontable.fixedHeader.adjust()})),$(window).resize((function(){}))},get_rolepositionInfo_tab:function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});app.ajax.html(app.data.tabHTML_RoleRositionInfo,{},null,(function(){$("#rolepositionInfo").html(app.ajax.result)}))},get_permissionsInfo_tab:function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});app.ajax.html(app.data.tabHTML_PermissionsInfo,{},null,(function(){$("#permissionsInfo").html(app.ajax.result)}))},foreach_handle_error_display:function(e,i){i.indexOf(" may only contain letters, numbers and spaces.")>=0&&((o=i.split(" may only contain letters, numbers and spaces.")[0].split("The ")[1].replace(/ /g,"_")).indexOf("fk_")>=0&&(o=o.replace("fk_",""),i=i.replace("fk ","")),"file"==o?($("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong></strong></span>'),$(".file-caption-name").after('<span style="padding-top:13px; margin-left: -13px;" class="help-block"><strong>'+i+"</strong></span>"),$(".file-caption-main").css("padding-bottom","20px")):($("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>")));i.indexOf("The file must be a file of type:")>=0&&((o=i.split(" must be a file of type:")[0].split("The ")[1].replace(/ /g,"_")).indexOf("fk_")>=0&&(o=o.replace("fk_",""),i=i.replace("fk ","")),"file"==o?($("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong></strong></span>'),$(".file-caption-name").after('<span style="padding-top:13px; margin-left: -13px;" class="help-block"><strong>'+i+"</strong></span>"),$(".file-caption-main").css("padding-bottom","20px")):($("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>")));i.indexOf(" failed to upload.")>=0&&((o=i.split(" failed to upload.")[0].split("The ")[1].replace(/ /g,"_")).indexOf("fk_")>=0&&(o=o.replace("fk_",""),i=i.replace("fk ","")),"file"==o?($("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong></strong></span>'),$(".file-caption-name").after('<span style="padding-top:13px; margin-left: -13px;" class="help-block"><strong>'+i+"</strong></span>"),$(".file-caption-main").css("padding-bottom","20px")):($("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>")));i.indexOf(" number can only contain numbers.")>=0&&((o=i.split(" number can only contain numbers.")[0].split("The ")[1].replace(/ /g,"_")).indexOf("fk_")>=0&&(o=o.replace("fk_",""),i=i.replace("fk ","")),$("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>"));i.indexOf(" may not be greater than ")>=0&&((o=i.split(" may not be greater than ")[0].split("The ")[1].replace(/ /g,"_")).indexOf("fk_")>=0&&(o=o.replace("fk_",""),i=i.replace("fk ","")),$("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>"));i.indexOf(" number can only contain numbers.")>=0&&((o=i.split(" number can only contain numbers.")[0].split("The ")[1].replace(/ /g,"_")).indexOf("fk_")>=0&&(o=o.replace("fk_",""),i=i.replace("fk ","")),$("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>"));i.indexOf("must be a number.")>=0&&((o=i.split(" must be a number.")[0].split("The ")[1].replace(/ /g,"_")).indexOf("fk_")>=0&&(o=o.replace("fk_",""),i=i.replace("fk ","")),$("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>"));i.indexOf(" must only contain numbers")>=0&&((o=i.split(" must only contain numbers")[0].replace(/ /g,"_")).indexOf("fk_")>=0&&(o=o.replace("fk_",""),i=i.replace("fk ","")),o.indexOf("contact_phone")>=0&&(o="work_"+o),$("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>"));i.indexOf("is not a valid date.")>=0&&((o=i.split(" is not a valid date.")[0].split("The ")[1].replace(/ /g,"_")).indexOf("fk_")>=0&&(o=o.replace("fk_",""),i=i.replace("fk ","")),$("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>"));i.indexOf(" field is required.")>=0&&((o=i.split(" field")[0].split("The ")[1].replace(/ /g,"_")).indexOf("fk_")>=0&&(o=o.replace("fk_",""),i=i.replace("fk ","")),"file"==o?($("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong></strong></span>'),$(".file-caption-name").after('<span style="padding-top:13px; margin-left: -13px;" class="help-block"><strong>'+i+"</strong></span>"),$(".file-caption-main").css("padding-bottom","20px")):($("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>")));if(i.indexOf(" must be at least ")>=0){var o=i.split(" must be at least")[0].split("The ")[1].replace(/ /g,"_");$("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>")}if(i.indexOf(" format is invalid.")>=0){o=i.split(" format is invalid.")[0].split("The ")[1].replace(/ /g,"_");$("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>")}if(i.indexOf(" field is required when ")>=0){o=i.split(" field is required when ")[0].split("The ")[1].replace(/ /g,"_");i=i.replace("fk ",""),$("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>")}if(i.indexOf(" must be between ")>=0){o=i.split(" must be between ")[0].split("The ")[1].replace(/ /g,"_");i=i.replace("fk ",""),$("#"+o).closest("td").addClass("has-error"),$("#"+o).after('<span class="help-block"><strong>'+i+"</strong></span>")}i.indexOf("Not Permitted")},filter:{byTeam:function(e){var i=app.util.build.team();$("div#team_filter").html(i),$("select[id='team_filter']").on("change",(function(){var i=$("#team_filter option:selected").map((function(){return $(this).text()})).get().join("|");i.indexOf("|")>=0||""==i?e.column(app.conf.table.filterColumn.routepermissions.team).search(i,!0,!1).draw():e.column(app.conf.table.filterColumn.routepermissions.team).search("^"+i+"$",!0,!1).draw()}))},byPosition:function(e){var i=app.util.build.position();$("div#position_filter").html(i),$("select[id='position_filter']").on("change",(function(){var i=$("#position_filter option:selected").map((function(){return $(this).text()})).get().join("|");i.indexOf("|")>=0||""==i?e.column(app.conf.table.filterColumn.routepermissions.position).search(i,!0,!1).draw():e.column(app.conf.table.filterColumn.routepermissions.position).search("^"+i+"$",!0,!1).draw()}))},byStatus:function(e){var i=app.util.build.status();$("div#status_filter").html(i),$("select[id='status_filter']").on("change",(function(){var i=$("#status_filter option:selected").map((function(){return $(this).val()})).get().join("|");e.column(app.conf.table.filterColumn.routepermissions.status+1).search(i,!0,!1).draw()}))},bySections:function(e){var i=app.util.build.sections();$("div#sections_filter").html(i),$("select[id='sections_filter']").on("change",(function(){var i=$("#sections_filter option:selected").map((function(){return $(this).text()})).get().join("|");e.column(app.conf.table.filterColumn.routepermissions.sections).search(i,!0,!1).draw()}))},exportExcel:function(e){var i=app.util.build.exportbutton(),o=i.search("data-action=")+13,t=[i.slice(0,o),"/employeeinfo_export",i.slice(o)].join("");$("div#export_buttonlocation").html(t)},clearallfilter:function(e){var i=app.util.build.clearallfiltersbutton();$("div#clear_filter").html(i)}},handle_route_permission:function(element_name){function toTitleCase(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))}function search(e){return"chips"===e.item}var checkbox_in_td=$("input[name='"+element_name+"']"),activate_or_deativate_text=null,activate_or_deativate=null,kind_of_confirm_box=null;checkbox_in_td.is(":checked")?(activate_or_deativate_text='<b style="color: Green; font-weight: 900;">ACTIVATE</b>',activate_or_deativate=1,kind_of_confirm_box="green"):(activate_or_deativate_text='<b style="color: Red; font-weight: 900;">DEACTIVATE</b>',activate_or_deativate=0,kind_of_confirm_box="red");var splitString=element_name.split("edit_"),isWritePermission=splitString[1].indexOf("_write_"),isReadPermission=splitString[1].indexOf("_read_"),role_permission_string=null,display_role_to_change=null,display_permission_to_change=null,checkagainst_permissions_type=null,checkagainst_permission_string=null,checkagainst_role_string=null,role_to_change_id=null,permission_to_change_id=null,resultcheck=null,first_word_length=null;isWritePermission>=0?(role_permission_string=splitString[1].split("_write_"),checkagainst_permissions_type="WRITE_",checkagainst_permission_string=checkagainst_permissions_type+role_permission_string[1],checkagainst_permission_string=checkagainst_permission_string.replace(/_/g," "),checkagainst_role_string=role_permission_string[0].replace(/_/g," "),resultcheck=checkagainst_role_string.split(" "),first_word_length=resultcheck[0].length,checkagainst_role_string=first_word_length<=2?resultcheck[0].toUpperCase()+" "+toTitleCase(resultcheck[1]):toTitleCase(checkagainst_role_string)):isReadPermission>=0&&(role_permission_string=splitString[1].split("_read_"),checkagainst_permissions_type="READ_",checkagainst_permission_string=checkagainst_permissions_type+role_permission_string[1],checkagainst_permission_string=checkagainst_permission_string.replace(/_/g," "),checkagainst_role_string=role_permission_string[0].replace(/_/g," "),resultcheck=checkagainst_role_string.split(" "),first_word_length=resultcheck[0].length,checkagainst_role_string=first_word_length<=2?resultcheck[0].toUpperCase()+" "+toTitleCase(resultcheck[1]):toTitleCase(checkagainst_role_string)),$.each(app.data.company_positions,(function(e,i){if(i.name==checkagainst_role_string)return role_to_change_id=e,!1})),$.each(app.data.company_permissions,(function(e,i){if(i.name==checkagainst_permission_string)return permission_to_change_id=e,!1})),isWritePermission>=0&&(display_permission_to_change='<b style="color: orange">'+checkagainst_permission_string+"</b>",display_role_to_change='<b style="color: blue">'+checkagainst_role_string+"'s </b>"),isReadPermission>=0&&(display_permission_to_change='<b style="color: orange">'+checkagainst_permission_string+"</b>",display_role_to_change='<b style="color: blue">'+checkagainst_role_string+"'s </b>");var canWRITEpermissions=app.data.auth_user_permissions.indexOf("WRITE permissions");canWRITEpermissions>=0&&$.confirm({title:eval("app.translations."+app.data.locale+".title_text"),content:activate_or_deativate_text+" the "+display_role_to_change+display_permission_to_change+" permission?",type:kind_of_confirm_box,draggable:!0,dragWindowGap:0,backgroundDismiss:"cancel",escapeKey:!0,animateFromElement:!1,onAction:function(e){$(".jconfirm.jconfirm-light.jconfirm-open").remove()},buttons:{ok:{btnClass:"btn-primary text-white",keys:["enter"],text:eval("app.translations."+app.data.locale+".okay_text"),action:function(){app.util.nprogressinit();var e={fk_role_id:role_to_change_id,fk_permission_id:permission_to_change_id,_token:$('meta[name="csrf-token"]').attr("content"),activate_or_deativate:activate_or_deativate};app.ajax.json(app.data.urlpostRoutePermissionSingleRecordChange,e,null,(function(){success_ajax_then_refresh=app.ajax.result.success,1==app.ajax.result.success||(checkbox_in_td.is(":checked")?checkbox_in_td.prop("checked",!1):checkbox_in_td.prop("checked",!0)),app.util.nprogressdone()}))}},cancel:{text:eval("app.translations."+app.data.locale+".cancel_text"),action:function(){checkbox_in_td.is(":checked")?checkbox_in_td.prop("checked",!1):checkbox_in_td.prop("checked",!0)}}}})}}}};
